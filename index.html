<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æœ¬ç§‘æ¯•ä¸šå»å‘å±‚æ¬¡åˆ†ææ³•æ¨èç³»ç»Ÿ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7f9fb;
        }
        .ahp-slider {
            -webkit-appearance: none;
            appearance: none;
            width: 100%;
            height: 12px;
            background: #e0e0e0;
            outline: none;
            opacity: 0.9;
            transition: opacity .2s;
            border-radius: 6px;
        }

        .ahp-slider:hover {
            opacity: 1;
        }

        .ahp-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            background: #1e40af; /* Blue-800 for thumb */
            cursor: pointer;
            border-radius: 50%;
            border: 4px solid #fff;
            box-shadow: 0 0 8px rgba(30, 64, 175, 0.4);
        }

        .ahp-slider::-moz-range-thumb {
            width: 24px;
            height: 24px;
            background: #1e40af; /* Blue-800 for thumb */
            cursor: pointer;
            border-radius: 50%;
            border: 4px solid #fff;
            box-shadow: 0 0 8px rgba(30, 64, 175, 0.4);
        }
        .cr-pass {
            background-color: #d1fae5;
            color: #065f46;
        }
        .cr-fail {
            background-color: #fee2e2;
            color: #991b1b;
        }

        /* ä¼˜åŒ–æ¸å˜è‰²ï¼Œå¢å¼ºç°ä»£æ„Ÿ */
        .gradient-bg {
            background: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%);
        }
    </style>
</head>
<body class="min-h-screen p-4 md:p-8">

    <div id="app" class="max-w-6xl mx-auto bg-white shadow-2xl rounded-xl p-6 md:p-10">

        <header class="mb-8 border-b pb-4">
            <h1 class="text-3xl font-extrabold text-gray-900">ğŸ“ æœ¬ç§‘æ¯•ä¸šå»å‘ AHP æ¨èç³»ç»Ÿ</h1>
            <p class="text-gray-500 mt-1">åŸºäºå±‚æ¬¡åˆ†ææ³•ï¼Œä¸ºæ‚¨é‡åŒ–æ¯•ä¸šé€‰æ‹©çš„é‡è¦æ€§ã€‚</p>
        </header>

        <div id="home-screen" class="text-center py-20">
            <div class="max-w-xl mx-auto p-8 rounded-xl shadow-inner border border-gray-100">
                <h2 class="text-4xl font-black text-gray-800 mb-4">å¼€å¯æ‚¨çš„èŒä¸šè§„åˆ’ä¹‹æ—…</h2>
                <p class="text-gray-600 mb-8">
                    æœ¬æµ‹è¯•å°†é€šè¿‡ 25 ä¸ªæˆå¯¹æ¯”è¾ƒåˆ¤æ–­é¢˜ï¼Œç»“åˆæ‚¨å¯¹ä¸åŒå‡†åˆ™ï¼ˆå¦‚ä»·å€¼å®ç°ã€å‘å±•æ½œåŠ›ã€é£é™©çº¦æŸç­‰ï¼‰çš„åå¥½ï¼Œ
                    è¿ç”¨å±‚æ¬¡åˆ†ææ³• (AHP) ä¸ºæ‚¨ç§‘å­¦åœ°æ¨èæœ€ä½³çš„æœ¬ç§‘æ¯•ä¸šå»å‘ã€‚
                </p>

                <div class="grid grid-cols-2 gap-4 text-left mb-10">
                    <div class="flex items-center text-gray-700">
                        <svg class="w-6 h-6 mr-2 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>
                        <span class="font-semibold">ç§‘å­¦é‡åŒ–å†³ç­–</span>
                    </div>
                    <div class="flex items-center text-gray-700">
                        <svg class="w-6 h-6 mr-2 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.108a12 12 0 11-13.843 13.843C6.444 20.374 8.27 21 10 21c3.866 0 7-3.134 7-7s-3.134-7-7-7z"></path></svg>
                        <span class="font-semibold">å…¨é¢è¦†ç›– 15 é¡¹å‡†åˆ™</span>
                    </div>
                </div>

                <button id="start-test-btn" class="px-10 py-3 gradient-bg text-white font-bold text-lg rounded-xl shadow-lg hover:shadow-xl transform hover:scale-105 transition duration-300">
                    å¼€å§‹æµ‹è¯• (å…± 25 é¢˜)
                </button>
            </div>

            <div class="max-w-xl mx-auto mt-8 p-6 rounded-xl shadow-lg border border-gray-200 bg-white">
                <h3 class="text-xl font-bold text-gray-700 mb-4 border-b pb-2">ğŸ“‚ æŸ¥çœ‹ç¤ºä¾‹ç»“æœ </h3>
                <p class="text-sm text-gray-500 mb-4">é€‰æ‹©ä¸€ä¸ªé¢„è®¾è§’è‰²ï¼Œç›´æ¥æŸ¥çœ‹å…¶å†³ç­–å€¾å‘ä¸‹çš„æ¨èç»“æœï¼š</p>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
                    <button data-preset="academic_pursuit" class="preset-btn px-4 py-2 bg-purple-100 text-purple-800 font-semibold rounded-lg shadow-sm hover:bg-purple-200 transition duration-150 text-sm">
                        ğŸ“š èƒ½åŠ›æå‡å‹
                    </button>
                    <button data-preset="stable_family" class="preset-btn px-4 py-2 bg-green-100 text-green-800 font-semibold rounded-lg shadow-sm hover:bg-green-200 transition duration-150 text-sm">
                        ğŸ¡ ç¨³å®šé¡¾å®¶å‹
                    </button>
                    <button data-preset="innovation_entrepreneurship" class="preset-btn px-4 py-2 bg-orange-100 text-orange-800 font-semibold rounded-lg shadow-sm hover:bg-orange-200 transition duration-150 text-sm">
                        ğŸ’¡ æ‘‡æ‘†ä¸å®šå‹
                    </button>
                </div>
            </div>

        </div>

        <div id="question-container" class="space-y-6" style="display: none;">
            </div>

        <div id="controls" class="mt-8 pt-4 border-t flex justify-between" style="display: none;">
            <button id="prev-btn" class="px-6 py-2 bg-gray-200 text-gray-700 font-semibold rounded-lg shadow-md hover:bg-gray-300 transition duration-150">
                â† ä¸Šä¸€æ­¥
            </button>
            <div id="progress-text" class="text-sm text-gray-500 flex items-center"></div>
            <button id="next-btn" class="px-6 py-2 bg-blue-600 text-white font-semibold rounded-lg shadow-md hover:bg-blue-700 transition duration-150">
                ä¸‹ä¸€æ­¥ â†’
            </button>
            <button id="finish-btn" class="px-6 py-2 bg-green-600 text-white font-semibold rounded-lg shadow-lg hover:bg-green-700 transition duration-150" style="display: none;">
                è®¡ç®—ç»“æœ
            </button>
        </div>

        <div id="results-container" class="mt-10" style="display: none;">
            <h2 class="text-3xl font-bold text-gray-900 mb-6">ğŸ† æ¨èç»“æœ</h2>

            <div id="ranking" class="grid md:grid-cols-3 gap-6 mb-8">
                </div>

            <div id="result-interpretation" class="mb-10 p-6 bg-blue-50 border-l-4 border-blue-600 rounded-lg shadow-md">
                <h3 class="text-2xl font-semibold text-blue-800 mb-3">ğŸ’¡ æ¨èç»“æœè§£è¯»</h3>
                <div id="interpretation-content" class="text-gray-700 space-y-3 text-base">
                    </div>
            </div>

            <div class="mt-10">
                <h3 class="text-2xl font-semibold text-gray-800 mb-4">ğŸ”¬ AHP è¯¦ç»†åˆ†æ</h3>

                <div class="mb-8">
                    <h4 class="text-xl font-medium mb-2 text-blue-600">æ‚¨çš„å‡†åˆ™åå¥½ï¼šäºŒçº§å‡†åˆ™å…¨å±€æƒé‡ (Global C Weights)</h4>
                    <table class="min-w-full bg-white border border-gray-200 rounded-lg overflow-hidden">
                        <thead>
                            <tr class="bg-blue-50 text-left text-sm font-medium text-gray-600 uppercase">
                                <th class="py-3 px-4 border-b">äºŒçº§å‡†åˆ™ (Criteria)</th>
                                <th class="py-3 px-4 border-b">å…¨å±€æƒé‡ (Importance)</th>
                            </tr>
                        </thead>
                        <tbody id="c-global-weights-body">
                            </tbody>
                    </table>
                </div>

                <div class="mb-8">
                    <h4 class="text-xl font-medium mb-2 text-blue-600">æ–¹æ¡ˆæ€»æƒé‡ (Global Alternatives Scores)</h4>
                    <table class="min-w-full bg-white border border-gray-200 rounded-lg overflow-hidden">
                        <thead>
                            <tr class="bg-blue-50 text-left text-sm font-medium text-gray-600 uppercase">
                                <th class="py-3 px-4 border-b">æ–¹æ¡ˆ (Alternative)</th>
                                <th class="py-3 px-4 border-b">æ€»æƒé‡ (Score)</th>
                            </tr>
                        </thead>
                        <tbody id="global-weights-body">
                            </tbody>
                    </table>
                </div>

                <div class="mb-8">
                    <h4 class="text-xl font-medium mb-2 text-blue-600">å±‚æ¬¡ä¸€è‡´æ€§æ£€éªŒ (CR Checks)</h4>
                    <table class="min-w-full bg-white border border-gray-200 rounded-lg overflow-hidden">
                        <thead>
                            <tr class="bg-blue-50 text-left text-sm font-medium text-gray-600 uppercase">
                                <th class="py-3 px-4 border-b">çŸ©é˜µ</th>
                                <th class="py-3 px-4 border-b">CR å€¼</th>
                                <th class="py-3 px-4 border-b">çŠ¶æ€</th>
                                <th class="py-3 px-4 border-b">æœ¬åœ°æƒé‡</th>
                            </tr>
                        </thead>
                        <tbody id="consistency-body">
                            </tbody>
                    </table>
                </div>
            </div>
        </div>

    </div>

    <script>
        // --- MANDATORY: Clear localStorage to ensure fresh tests ---
        localStorage.clear();

        // --- AHP CONFIGURATION AND DATA ---

        // éšæœºä¸€è‡´æ€§æŒ‡æ ‡ (Random Index - RI)
        const RI = [0, 0, 0.58, 0.90, 1.12, 1.24, 1.32, 1.41, 1.45, 1.49, 1.51, 1.54, 1.56, 1.58, 1.59];

        // ç›®æ ‡å±‚å’Œå‡†åˆ™åç§°
        const GOAL = "æœ€ä½³æœ¬ç§‘ç”Ÿæ¯•ä¸šå»å‘";
        const B_CRITERIA_NAMES = {
            'B1': 'ä¸ªä½“ä»·å€¼',
            'B2': 'å‘å±•æ½œåŠ›',
            'B3': 'èµ„æºé€‚é…',
            'B4': 'é£é™©çº¦æŸ',
            'B5': 'ç¤¾ä¼šå…³è”'
        };
        const C_CRITERIA_NAMES = {
            'C1': 'è‡ªæˆ‘ä»·å€¼å®ç°åº¦', 'C2': 'ä¸“ä¸šèƒ½åŠ›å¥‘åˆåº¦', 'C3': 'å…´è¶£æ€§æ ¼é€‚é…æ€§',
            'C4': 'èƒ½åŠ›æˆé•¿ç©ºé—´', 'C5': 'èŒä¸šæ™‹å‡é€Ÿåº¦', 'C6': 'è¡Œä¸šå‘å±•å‰æ™¯',
            'C7': 'ç»æµé€‚é…æ€§', 'C8': 'èµ„æºå¯åŠæ€§', 'C9': 'æ—¶é—´æˆæœ¬',
            'C10': 'è·¯å¾„é£é™©ç³»æ•°', 'C11': 'é€‰æ‹©å¯é€†æ€§', 'C12': 'ä¸ç¡®å®šæ€§å®¹å¿åº¦',
            'C13': 'ç¤¾ä¼šè´¡çŒ®åº¦', 'C14': 'äººè„‰èµ„æºç§¯ç´¯', 'C15': 'å®¶åº­åŒ¹é…åº¦'
        };
        const A_ALTERNATIVES_NAMES = {
            'A1': 'å›½å†…è¯»ç ”', 'A2': 'å‡ºå›½ç•™å­¦', 'A3': 'è€ƒå…¬åŠ¡å‘˜', 'A4': 'è€ƒäº‹ä¸šç¼–', 'A5': 'å…¥èŒä¼ä¸š',
            'A6': 'å°æœ¬åˆ›ä¸š', 'A7': 'å…¨èŒè‡ªåª’ä½“', 'A8': 'æ”¯æ•™æœåŠ¡', 'A9': 'å¾…ä¸šå¤‡è€ƒ', 'A10': 'çµæ´»å°±ä¸š',
            'A11': 'åŸ¹è®­æœºæ„', 'A12': 'å­æ‰¿çˆ¶ä¸š', 'A13': 'åŸºå±‚æœåŠ¡', 'A14': 'æŠ€æœ¯å­¦å¾’', 'A15': 'gapä¸€å¹´'
        };
        const C_ORDER = ['C1', 'C2', 'C3', 'C4', 'C5', 'C6', 'C7', 'C8', 'C9', 'C10', 'C11', 'C12', 'C13', 'C14', 'C15'];
        const B_MAPPING = {
            'B1': ['C1', 'C2', 'C3'],
            'B2': ['C4', 'C5', 'C6'],
            'B3': ['C7', 'C8', 'C9'],
            'B4': ['C10', 'C11', 'C12'],
            'B5': ['C13', 'C14', 'C15']
        };

        // --- é¢„è®¾ç”¨æˆ·ç­”æ¡ˆ (Slider Value 1-17) ---
        // 1-8 åå‘ ColName, 9=1, 10-17 åå‘ RowName
        const PRESET_ANSWERS = {
            'academic_pursuit': { // ğŸ“š è¿½æ±‚èƒ½åŠ›æå‡è€…: B2 (å‘å±•æ½œåŠ›) >>> B1 (ä¸ªä½“ä»·å€¼) >> B3 (èµ„æºé€‚é…) >> B4 (é£é™©çº¦æŸ)/B5 (ç¤¾ä¼šå…³è”)
                // G-B Matrix (10 Qs)
                // B1 vs B2(1/3), B1 vs B3(3), B1 vs B4(5), B1 vs B5(3)
                // B2 vs B3(5), B2 vs B4(7), B2 vs B5(5)
                // B3 vs B4(3), B3 vs B5(2)
                // B4 vs B5(1/2)
                G_B: [7, 13, 15, 13, 15, 17, 15, 13, 11, 8],
                // B1-C Matrix (3 Qs: C1, C2, C3) -> C2æœ€é«˜ (ä¸“ä¸šèƒ½åŠ›å¥‘åˆåº¦)
                // C1 vs C2(1/3), C1 vs C3(1), C2 vs C3(3)
                B1: [7, 9, 13],
                // B2-C Matrix (3 Qs: C4, C5, C6) -> C4æœ€é«˜ (èƒ½åŠ›æˆé•¿ç©ºé—´)
                // C4 vs C5(3), C4 vs C6(2), C5 vs C6(1)
                B2: [13, 11, 9],
                // B3-C Matrix (3 Qs: C7, C8, C9) -> C8æœ€é«˜ (èµ„æºå¯åŠæ€§)
                // C7 vs C8(1/3), C7 vs C9(1), C8 vs C9(3)
                B3: [7, 9, 13],
                // B4-C Matrix (3 Qs: C10, C11, C12) -> C12æœ€é«˜ (ä¸ç¡®å®šæ€§å®¹å¿åº¦)
                // C10 vs C11(1), C10 vs C12(1/3), C11 vs C12(1/3)
                B4: [9, 7, 7],
                // B5-C Matrix (3 Qs: C13, C14, C15) -> C14æœ€é«˜ (äººè„‰èµ„æºç§¯ç´¯)
                // C13 vs C14(1/2), C13 vs C15(1), C14 vs C15(2)
                B5: [8, 9, 11]
            },
            'stable_family': { // ğŸ¡ ç¨³å®šé¡¾å®¶å‹: B4 (é£é™©çº¦æŸ) >>> B5 (ç¤¾ä¼šå…³è”) >> B3 (èµ„æºé€‚é…) >> B1 (ä¸ªä½“ä»·å€¼)/B2 (å‘å±•æ½œåŠ›)
                // G-B Matrix (10 Qs)
                // B1 vs B2(1), B1 vs B3(1/3), B1 vs B4(1/7), B1 vs B5(1/5)
                // B2 vs B3(1/3), B2 vs B4(1/7), B2 vs B5(1/5)
                // B3 vs B4(1/5), B3 vs B5(1/3)
                // B4 vs B5(3)
                G_B: [9, 7, 3, 5, 7, 3, 5, 5, 7, 13],
                // B1-C Matrix (3 Qs: C1, C2, C3) -> C3æœ€é«˜ (å…´è¶£æ€§æ ¼é€‚é…æ€§)
                // C1 vs C2(1/2), C1 vs C3(1/3), C2 vs C3(1/2)
                B1: [8, 7, 8],
                // B2-C Matrix (3 Qs: C4, C5, C6) -> C4æœ€ä½ (èƒ½åŠ›æˆé•¿ç©ºé—´)
                // C4 vs C5(1/5), C4 vs C6(1/3), C5 vs C6(2)
                B2: [5, 7, 11],
                // B3-C Matrix (3 Qs: C7, C8, C9) -> C8, C9æœ€ä½ (èµ„æºã€æ—¶é—´ä¸é‡è¦)
                // C7 vs C8(3), C7 vs C9(3), C8 vs C9(1)
                B3: [13, 13, 9],
                // B4-C Matrix (3 Qs: C10, C11, C12) -> C10, C12æœ€é«˜ (è·¯å¾„é£é™©ç³»æ•°, ä¸ç¡®å®šæ€§å®¹å¿åº¦)
                // C10 vs C11(5), C10 vs C12(3), C11 vs C12(1/3)
                B4: [15, 13, 7],
                // B5-C Matrix (3 Qs: C13, C14, C15) -> C15æœ€é«˜ (å®¶åº­åŒ¹é…åº¦)
                // C13 vs C14(1/5), C13 vs C15(1/7), C14 vs C15(1/3)
                B5: [5, 3, 7]
            },
            'innovation_entrepreneurship': { // ğŸ’¡ æ‘‡æ‘†ä¸å®šå‹: B2 (å‘å±•æ½œåŠ›) >>> B3 (èµ„æºé€‚é…) >> B12 (ä¸ç¡®å®šæ€§å®¹å¿åº¦) >> B1 (ä¸ªä½“ä»·å€¼)/B5 (ç¤¾ä¼šå…³è”)
                // G-B Matrix (10 Qs)
                // B1 vs B2(1/5), B1 vs B3(1/3), B1 vs B4(3), B1 vs B5(2)
                // B2 vs B3(3), B2 vs B4(7), B2 vs B5(5)
                // B3 vs B4(5), B3 vs B5(3)
                // B4 vs B5(1/2)
                G_B: [11, 7, 3, 11, 5, 1, 9, 5, 15, 17],
                // B1-C Matrix (3 Qs) - æ¬¡è¦ç»´åº¦ï¼ŒC3(å…´è¶£é€‚é…)ç•¥é«˜
                // C1 vs C2(1), C1 vs C3(1/2), C2 vs C3(1/2)
                B1: [9, 8, 7],
                // B2-C Matrix (3 Qs) - æƒé‡æœ€ä½ï¼ŒC6(è¡Œä¸šå‰æ™¯)ç•¥é«˜
                // C4 vs C5(1/3), C4 vs C6(1/5), C5 vs C6(1/2)
                B2: [7, 5, 8],
                // B3-C Matrix (3 Qs) - èµ„æºé€‚é…ä¸ºè¾…åŠ©ï¼ŒC8(èµ„æºå¯åŠæ€§)ç•¥é«˜
                // C7 vs C8(1/3), C7 vs C9(1), C8 vs C9(3)
                B3: [7, 11, 13],
                // B4-C Matrix (3 Qs) - æ ¸å¿ƒå¼ºåŒ–C11(é€‰æ‹©å¯é€†æ€§)ï¼Œæƒé‡è¿œè¶…å…¶ä»–
                // C10 vs C11(1/9), C10 vs C12(1/3), C11 vs C12(7)
                B4: [1, 7, 15],
                // B5-C Matrix (3 Qs) - ç¤¾ä¼šå…³è”æƒé‡æœ€ä½ï¼ŒC14(äººè„‰)ç•¥é«˜
                // C13 vs C14(1/3), C13 vs C15(1/2), C14 vs C15(2)
                B5: [7, 11, 8]
            }
        };

        // --- 15x15 C -> A MATRICES (Generated from User's CSV Scores) ---
        // (ä¿æŒä¸ä¸Šä¸€è½®ç›¸åŒçš„C->AçŸ©é˜µï¼Œç¡®ä¿æ¨èç»“æœåŸºäºæ‚¨çš„ä¸“å®¶æ‰“åˆ†)
        const C_TO_A_MATRICES = {
            'C1': [
                [1, 1, 3, 3, 0.5, 0.333333, 0.25, 2, 4, 0.5, 1, 5, 2, 0.5, 4],
                [1, 1, 3, 3, 0.5, 0.333333, 0.25, 2, 4, 0.5, 1, 5, 2, 0.5, 4],
                [0.333333, 0.333333, 1, 1, 0.25, 0.2, 0.166667, 0.5, 2, 0.25, 0.333333, 3, 1, 0.25, 2],
                [0.333333, 0.333333, 1, 1, 0.25, 0.2, 0.166667, 0.5, 2, 0.25, 0.333333, 3, 1, 0.25, 2],
                [2, 2, 4, 4, 1, 0.5, 0.333333, 3, 5, 1, 2, 6, 3, 1, 5],
                [3, 3, 5, 5, 2, 1, 0.5, 4, 6, 2, 3, 7, 4, 2, 6],
                [4, 4, 6, 6, 3, 2, 1, 5, 7, 3, 4, 8, 5, 3, 7],
                [0.5, 0.5, 2, 2, 0.333333, 0.25, 0.2, 1, 3, 0.333333, 0.5, 4, 0.5, 0.333333, 3],
                [0.25, 0.25, 0.5, 0.5, 0.2, 0.166667, 0.142857, 0.333333, 1, 0.2, 0.25, 2, 0.333333, 0.2, 1],
                [2, 2, 4, 4, 1, 0.5, 0.333333, 3, 5, 1, 2, 6, 3, 1, 5],
                [1, 1, 3, 3, 0.5, 0.333333, 0.25, 2, 4, 0.5, 1, 5, 2, 0.5, 4],
                [0.2, 0.2, 0.333333, 0.333333, 0.166667, 0.142857, 0.125, 0.25, 0.5, 0.166667, 0.2, 1, 0.25, 0.166667, 0.5],
                [0.5, 0.5, 1, 1, 0.333333, 0.25, 0.2, 2, 3, 0.333333, 0.5, 4, 1, 0.333333, 3],
                [2, 2, 4, 4, 1, 0.5, 0.333333, 3, 5, 1, 2, 6, 3, 1, 5],
                [0.25, 0.25, 0.5, 0.5, 0.2, 0.166667, 0.142857, 0.333333, 1, 0.2, 0.25, 2, 0.333333, 0.2, 1]
            ],
            'C2': [
                [1, 1, 3, 3, 0.5, 0.333333, 0.25, 2, 4, 0.333333, 0.5, 5, 2, 0.333333, 4],
                [1, 1, 3, 3, 0.5, 0.333333, 0.25, 2, 4, 0.333333, 0.5, 5, 2, 0.333333, 4],
                [0.333333, 0.333333, 1, 1, 0.25, 0.2, 0.166667, 0.5, 2, 0.2, 0.25, 3, 1, 0.2, 2],
                [0.333333, 0.333333, 1, 1, 0.25, 0.2, 0.166667, 0.5, 2, 0.2, 0.25, 3, 1, 0.2, 2],
                [2, 2, 4, 4, 1, 0.5, 0.333333, 3, 5, 0.5, 1, 6, 3, 0.5, 5],
                [3, 3, 5, 5, 2, 1, 0.5, 4, 6, 1, 2, 7, 4, 1, 6],
                [4, 4, 6, 6, 3, 2, 1, 5, 7, 2, 3, 8, 5, 2, 7],
                [0.5, 0.5, 2, 2, 0.333333, 0.25, 0.2, 1, 3, 0.25, 0.333333, 4, 0.5, 0.25, 3],
                [0.25, 0.25, 0.5, 0.5, 0.2, 0.166667, 0.142857, 0.333333, 1, 0.166667, 0.2, 2, 0.333333, 0.166667, 1],
                [3, 3, 5, 5, 2, 1, 0.5, 4, 6, 1, 2, 7, 4, 1, 6],
                [2, 2, 4, 4, 1, 0.5, 0.333333, 3, 5, 0.5, 1, 6, 3, 0.5, 5],
                [0.2, 0.2, 0.333333, 0.333333, 0.166667, 0.142857, 0.125, 0.25, 0.5, 0.142857, 0.166667, 1, 0.25, 0.142857, 0.5],
                [0.5, 0.5, 1, 1, 0.333333, 0.25, 0.2, 2, 3, 0.25, 0.333333, 4, 1, 0.25, 3],
                [3, 3, 5, 5, 2, 1, 0.5, 4, 6, 1, 2, 7, 4, 1, 6],
                [0.25, 0.25, 0.5, 0.5, 0.2, 0.166667, 0.142857, 0.333333, 1, 0.166667, 0.2, 2, 0.333333, 0.166667, 1]
            ],
            'C3': [
                [1, 1, 3, 3, 2, 0.5, 0.333333, 0.5, 2, 0.333333, 1, 4, 0.5, 0.5, 2],
                [1, 1, 3, 3, 2, 0.5, 0.333333, 0.5, 2, 0.333333, 1, 4, 0.5, 0.5, 2],
                [0.333333, 0.333333, 1, 1, 0.5, 0.25, 0.2, 0.25, 0.5, 0.2, 0.333333, 2, 0.25, 0.25, 0.5],
                [0.333333, 0.333333, 1, 1, 0.5, 0.25, 0.2, 0.25, 0.5, 0.2, 0.333333, 2, 0.25, 0.25, 0.5],
                [0.5, 0.5, 2, 2, 1, 0.333333, 0.25, 0.333333, 1, 0.25, 0.5, 3, 0.333333, 0.333333, 1],
                [2, 2, 4, 4, 3, 1, 0.5, 0.5, 3, 0.5, 2, 5, 0.5, 0.5, 3],
                [3, 3, 5, 5, 4, 2, 1, 1, 4, 1, 3, 6, 1, 1, 4],
                [2, 2, 4, 4, 3, 2, 1, 1, 3, 1, 2, 5, 1, 1, 3],
                [0.5, 0.5, 2, 2, 1, 0.333333, 0.25, 0.333333, 1, 0.25, 0.5, 3, 0.333333, 0.333333, 1],
                [3, 3, 5, 5, 4, 2, 1, 1, 4, 1, 3, 6, 1, 1, 4],
                [1, 1, 3, 3, 2, 0.5, 0.333333, 0.5, 2, 0.333333, 1, 4, 0.5, 0.5, 2],
                [0.25, 0.25, 0.5, 0.5, 0.333333, 0.2, 0.166667, 0.2, 0.333333, 0.166667, 0.25, 1, 0.2, 0.2, 0.333333],
                [2, 2, 4, 4, 3, 2, 1, 1, 3, 1, 2, 5, 1, 1, 3],
                [2, 2, 4, 4, 3, 2, 1, 1, 3, 1, 2, 5, 1, 1, 3],
                [0.5, 0.5, 2, 2, 1, 0.333333, 0.25, 0.333333, 1, 0.25, 0.5, 3, 0.333333, 0.333333, 1]
            ],
            'C4': [
                [1, 1, 3, 3, 0.5, 0.5, 0.333333, 2, 4, 0.5, 1, 5, 2, 0.333333, 4],
                [1, 1, 3, 3, 0.5, 0.5, 0.333333, 2, 4, 0.5, 1, 5, 2, 0.333333, 4],
                [0.333333, 0.333333, 1, 1, 0.25, 0.25, 0.2, 0.5, 2, 0.25, 0.333333, 3, 1, 0.2, 2],
                [0.333333, 0.333333, 1, 1, 0.25, 0.25, 0.2, 0.5, 2, 0.25, 0.333333, 3, 1, 0.2, 2],
                [2, 2, 4, 4, 1, 1, 0.5, 3, 5, 1, 2, 6, 3, 0.5, 5],
                [2, 2, 4, 4, 1, 1, 0.5, 3, 5, 1, 2, 6, 3, 0.5, 5],
                [3, 3, 5, 5, 2, 2, 1, 4, 6, 2, 3, 7, 4, 1, 6],
                [0.5, 0.5, 2, 2, 0.333333, 0.333333, 0.25, 1, 3, 0.333333, 0.5, 4, 0.5, 0.25, 3],
                [0.25, 0.25, 0.5, 0.5, 0.2, 0.2, 0.166667, 0.333333, 1, 0.2, 0.25, 2, 0.333333, 0.166667, 1],
                [2, 2, 4, 4, 1, 1, 0.5, 3, 5, 1, 2, 6, 3, 0.5, 5],
                [1, 1, 3, 3, 0.5, 0.5, 0.333333, 2, 4, 0.5, 1, 5, 2, 0.333333, 4],
                [0.2, 0.2, 0.333333, 0.333333, 0.166667, 0.166667, 0.142857, 0.25, 0.5, 0.166667, 0.2, 1, 0.25, 0.142857, 0.5],
                [0.5, 0.5, 1, 1, 0.333333, 0.333333, 0.25, 2, 3, 0.333333, 0.5, 4, 1, 0.25, 3],
                [3, 3, 5, 5, 2, 2, 1, 4, 6, 2, 3, 7, 4, 1, 6],
                [0.25, 0.25, 0.5, 0.5, 0.2, 0.2, 0.166667, 0.333333, 1, 0.2, 0.25, 2, 0.333333, 0.166667, 1]
            ],
            'C5': [
                [1, 1, 0.5, 0.5, 0.333333, 0.25, 0.2, 2, 4, 0.25, 0.333333, 5, 2, 0.25, 4],
                [1, 1, 0.5, 0.5, 0.333333, 0.25, 0.2, 2, 4, 0.25, 0.333333, 5, 2, 0.25, 4],
                [2, 2, 1, 1, 0.5, 0.333333, 0.25, 3, 5, 0.333333, 0.5, 6, 3, 0.333333, 5],
                [2, 2, 1, 1, 0.5, 0.333333, 0.25, 3, 5, 0.333333, 0.5, 6, 3, 0.333333, 5],
                [3, 3, 2, 2, 1, 0.5, 0.333333, 4, 6, 0.5, 1, 7, 4, 0.5, 6],
                [4, 4, 3, 3, 2, 1, 0.5, 5, 7, 1, 2, 8, 5, 1, 7],
                [5, 5, 4, 4, 3, 2, 1, 6, 8, 2, 3, 9, 6, 2, 8],
                [0.5, 0.5, 0.333333, 0.333333, 0.25, 0.2, 0.166667, 1, 3, 0.2, 0.25, 4, 0.5, 0.2, 3],
                [0.25, 0.25, 0.2, 0.2, 0.166667, 0.142857, 0.125, 0.333333, 1, 0.142857, 0.166667, 2, 0.333333, 0.142857, 1],
                [4, 4, 3, 3, 2, 1, 0.5, 5, 7, 1, 2, 8, 5, 1, 7],
                [3, 3, 2, 2, 1, 0.5, 0.333333, 4, 6, 0.5, 1, 7, 4, 0.5, 6],
                [0.2, 0.2, 0.166667, 0.166667, 0.142857, 0.125, 0.111111, 0.25, 0.5, 0.125, 0.142857, 1, 0.25, 0.125, 0.5],
                [0.5, 0.5, 0.333333, 0.333333, 0.25, 0.2, 0.166667, 2, 3, 0.2, 0.25, 4, 1, 0.2, 3],
                [4, 4, 3, 3, 2, 1, 0.5, 5, 7, 1, 2, 8, 5, 1, 7],
                [0.25, 0.25, 0.2, 0.2, 0.166667, 0.142857, 0.125, 0.333333, 1, 0.142857, 0.166667, 2, 0.333333, 0.142857, 1]
            ],
            'C6': [
                [1, 1, 3, 3, 0.5, 0.5, 0.333333, 2, 4, 0.5, 1, 5, 2, 0.5, 4],
                [1, 1, 3, 3, 0.5, 0.5, 0.333333, 2, 4, 0.5, 1, 5, 2, 0.5, 4],
                [0.333333, 0.333333, 1, 1, 0.25, 0.25, 0.2, 0.5, 2, 0.25, 0.333333, 3, 1, 0.25, 2],
                [0.333333, 0.333333, 1, 1, 0.25, 0.25, 0.2, 0.5, 2, 0.25, 0.333333, 3, 1, 0.25, 2],
                [2, 2, 4, 4, 1, 1, 0.5, 3, 5, 1, 2, 6, 3, 1, 5],
                [2, 2, 4, 4, 1, 1, 0.5, 3, 5, 1, 2, 6, 3, 1, 5],
                [3, 3, 5, 5, 2, 2, 1, 4, 6, 2, 3, 7, 4, 2, 6],
                [0.5, 0.5, 2, 2, 0.333333, 0.333333, 0.25, 1, 3, 0.333333, 0.5, 4, 0.5, 0.333333, 3],
                [0.25, 0.25, 0.5, 0.5, 0.2, 0.2, 0.166667, 0.333333, 1, 0.2, 0.25, 2, 0.333333, 0.2, 1],
                [2, 2, 4, 4, 1, 1, 0.5, 3, 5, 1, 2, 6, 3, 1, 5],
                [1, 1, 3, 3, 0.5, 0.5, 0.333333, 2, 4, 0.5, 1, 5, 2, 0.5, 4],
                [0.2, 0.2, 0.333333, 0.333333, 0.166667, 0.166667, 0.142857, 0.25, 0.5, 0.166667, 0.2, 1, 0.25, 0.166667, 0.5],
                [0.5, 0.5, 1, 1, 0.333333, 0.333333, 0.25, 2, 3, 0.333333, 0.5, 4, 1, 0.333333, 3],
                [2, 2, 4, 4, 1, 1, 0.5, 3, 5, 1, 2, 6, 3, 1, 5],
                [0.25, 0.25, 0.5, 0.5, 0.2, 0.2, 0.166667, 0.333333, 1, 0.2, 0.25, 2, 0.333333, 0.2, 1]
            ],
            'C7': [
                [1, 0.5, 0.25, 0.25, 0.2, 0.333333, 0.333333, 2, 0.5, 0.333333, 0.333333, 0.166667, 2, 0.333333, 0.5],
                [2, 1, 0.333333, 0.333333, 0.25, 0.5, 0.5, 3, 1, 0.5, 0.5, 0.2, 3, 0.5, 1],
                [4, 3, 1, 1, 0.5, 2, 2, 5, 3, 2, 2, 0.5, 5, 2, 3],
                [4, 3, 1, 1, 0.5, 2, 2, 5, 3, 2, 2, 0.5, 5, 2, 3],
                [5, 4, 2, 2, 1, 3, 3, 6, 4, 3, 3, 0.333333, 6, 3, 4],
                [3, 2, 0.5, 0.5, 0.333333, 1, 1, 4, 2, 1, 1, 0.25, 4, 1, 2],
                [3, 2, 0.5, 0.5, 0.333333, 1, 1, 4, 2, 1, 1, 0.25, 4, 1, 2],
                [0.5, 0.333333, 0.2, 0.2, 0.166667, 0.25, 0.25, 1, 0.25, 0.25, 0.25, 0.142857, 1, 0.25, 0.25],
                [2, 1, 0.333333, 0.333333, 0.25, 0.5, 0.5, 4, 1, 0.5, 0.5, 0.2, 4, 0.5, 1],
                [3, 2, 0.5, 0.5, 0.333333, 1, 1, 4, 2, 1, 1, 0.25, 4, 1, 2],
                [3, 2, 0.5, 0.5, 0.333333, 1, 1, 4, 2, 1, 1, 0.25, 4, 1, 2],
                [6, 5, 2, 2, 3, 4, 4, 7, 5, 4, 4, 1, 7, 4, 5],
                [0.5, 0.333333, 0.2, 0.2, 0.166667, 0.25, 0.25, 1, 0.25, 0.25, 0.25, 0.142857, 1, 0.25, 0.25],
                [3, 2, 0.5, 0.5, 0.333333, 1, 1, 4, 2, 1, 1, 0.25, 4, 1, 2],
                [2, 1, 0.333333, 0.333333, 0.25, 0.5, 0.5, 4, 1, 0.5, 0.5, 0.2, 4, 0.5, 1]
            ],
            'C8': [
                [1, 1, 0.5, 0.5, 0.333333, 2, 2, 3, 1, 2, 0.5, 0.5, 3, 2, 1],
                [1, 1, 0.5, 0.5, 0.333333, 2, 2, 3, 1, 2, 0.5, 0.5, 3, 2, 1],
                [2, 2, 1, 1, 0.5, 3, 3, 4, 2, 3, 1, 1, 4, 3, 2],
                [2, 2, 1, 1, 0.5, 3, 3, 4, 2, 3, 1, 1, 4, 3, 2],
                [3, 3, 2, 2, 1, 4, 4, 5, 3, 4, 2, 2, 5, 4, 3],
                [0.5, 0.5, 0.333333, 0.333333, 0.25, 1, 1, 2, 0.5, 1, 0.333333, 0.333333, 2, 1, 0.5],
                [0.5, 0.5, 0.333333, 0.333333, 0.25, 1, 1, 2, 0.5, 1, 0.333333, 0.333333, 2, 1, 0.5],
                [0.333333, 0.333333, 0.25, 0.25, 0.2, 0.5, 0.5, 1, 0.333333, 0.5, 0.25, 0.25, 1, 0.5, 0.333333],
                [1, 1, 0.5, 0.5, 0.333333, 2, 2, 3, 1, 2, 0.5, 0.5, 3, 2, 1],
                [0.5, 0.5, 0.333333, 0.333333, 0.25, 1, 1, 2, 0.5, 1, 0.333333, 0.333333, 2, 1, 0.5],
                [2, 2, 1, 1, 0.5, 3, 3, 4, 2, 3, 1, 1, 4, 3, 2],
                [2, 2, 1, 1, 0.5, 3, 3, 4, 2, 3, 1, 1, 4, 3, 2],
                [0.333333, 0.333333, 0.25, 0.25, 0.2, 0.5, 0.5, 1, 0.333333, 0.5, 0.25, 0.25, 1, 0.5, 0.333333],
                [0.5, 0.5, 0.333333, 0.333333, 0.25, 1, 1, 2, 0.5, 1, 0.333333, 0.333333, 2, 1, 0.5],
                [1, 1, 0.5, 0.5, 0.333333, 2, 2, 3, 1, 2, 0.5, 0.5, 3, 2, 1]
            ],
            'C9': [
                [1, 1, 0.333333, 0.333333, 0.25, 0.5, 0.5, 2, 0.5, 0.5, 0.5, 0.333333, 2, 0.5, 0.5],
                [1, 1, 0.333333, 0.333333, 0.25, 0.5, 0.5, 2, 0.5, 0.5, 0.5, 0.333333, 2, 0.5, 0.5],
                [3, 3, 1, 1, 0.5, 2, 2, 4, 2, 2, 2, 1, 4, 2, 2],
                [3, 3, 1, 1, 0.5, 2, 2, 4, 2, 2, 2, 1, 4, 2, 2],
                [4, 4, 2, 2, 1, 3, 3, 5, 3, 3, 3, 2, 5, 3, 3],
                [2, 2, 0.5, 0.5, 0.333333, 1, 1, 3, 1, 1, 1, 0.5, 3, 1, 1],
                [2, 2, 0.5, 0.5, 0.333333, 1, 1, 3, 1, 1, 1, 0.5, 3, 1, 1],
                [0.5, 0.5, 0.25, 0.25, 0.2, 0.333333, 0.333333, 1, 0.333333, 0.333333, 0.333333, 0.25, 1, 0.333333, 0.333333],
                [2, 2, 0.5, 0.5, 0.333333, 1, 1, 3, 1, 1, 1, 0.5, 3, 1, 1],
                [2, 2, 0.5, 0.5, 0.333333, 1, 1, 3, 1, 1, 1, 0.5, 3, 1, 1],
                [2, 2, 0.5, 0.5, 0.333333, 1, 1, 3, 1, 1, 1, 0.5, 3, 1, 1],
                [3, 3, 1, 1, 0.5, 2, 2, 4, 2, 2, 2, 1, 4, 2, 2],
                [0.5, 0.5, 0.25, 0.25, 0.2, 0.333333, 0.333333, 1, 0.333333, 0.333333, 0.333333, 0.25, 1, 0.333333, 0.333333],
                [2, 2, 0.5, 0.5, 0.333333, 1, 1, 3, 1, 1, 1, 0.5, 3, 1, 1],
                [2, 2, 0.5, 0.5, 0.333333, 1, 1, 3, 1, 1, 1, 0.5, 3, 1, 1]
            ],
            'C10': [
                [1, 1, 0.5, 0.5, 2, 3, 3, 2, 4, 2, 1, 0.5, 2, 2, 4],
                [1, 1, 0.5, 0.5, 2, 3, 3, 2, 4, 2, 1, 0.5, 2, 2, 4],
                [2, 2, 1, 1, 3, 4, 4, 3, 5, 3, 2, 1, 3, 3, 5],
                [2, 2, 1, 1, 3, 4, 4, 3, 5, 3, 2, 1, 3, 3, 5],
                [0.5, 0.5, 0.333333, 0.333333, 1, 2, 2, 1, 3, 1, 0.5, 0.333333, 1, 1, 3],
                [0.333333, 0.333333, 0.25, 0.25, 0.5, 1, 1, 0.5, 2, 0.5, 0.333333, 0.25, 0.5, 0.5, 2],
                [0.333333, 0.333333, 0.25, 0.25, 0.5, 1, 1, 0.5, 2, 0.5, 0.333333, 0.25, 0.5, 0.5, 2],
                [0.5, 0.5, 0.333333, 0.333333, 1, 2, 2, 1, 3, 1, 0.5, 0.333333, 1, 1, 3],
                [0.25, 0.25, 0.2, 0.2, 0.333333, 0.5, 0.5, 0.333333, 1, 0.333333, 0.25, 0.2, 0.333333, 0.333333, 1],
                [0.5, 0.5, 0.333333, 0.333333, 1, 2, 2, 1, 3, 1, 0.5, 0.333333, 1, 1, 3],
                [1, 1, 0.5, 0.5, 2, 3, 3, 2, 4, 2, 1, 0.5, 2, 2, 4],
                [2, 2, 1, 1, 3, 4, 4, 3, 5, 3, 2, 1, 3, 3, 5],
                [0.5, 0.5, 0.333333, 0.333333, 1, 2, 2, 1, 3, 1, 0.5, 0.333333, 1, 1, 3],
                [0.5, 0.5, 0.333333, 0.333333, 1, 2, 2, 1, 3, 1, 0.5, 0.333333, 1, 1, 3],
                [0.25, 0.25, 0.2, 0.2, 0.333333, 0.5, 0.5, 0.333333, 1, 0.333333, 0.25, 0.2, 0.333333, 0.333333, 1]
            ],
            'C11': [
                [1, 1, 3, 3, 0.5, 2, 2, 3, 0.5, 2, 1, 4, 3, 0.5, 0.5],
                [1, 1, 3, 3, 0.5, 2, 2, 3, 0.5, 2, 1, 4, 3, 0.5, 0.5],
                [0.333333, 0.333333, 1, 1, 0.25, 0.5, 0.5, 1, 0.25, 0.5, 0.333333, 2, 1, 0.25, 0.25],
                [0.333333, 0.333333, 1, 1, 0.25, 0.5, 0.5, 1, 0.25, 0.5, 0.333333, 2, 1, 0.25, 0.25],
                [2, 2, 4, 4, 1, 3, 3, 4, 1, 3, 2, 5, 4, 1, 1],
                [0.5, 0.5, 2, 2, 0.333333, 1, 1, 2, 0.333333, 1, 0.5, 3, 2, 0.333333, 0.333333],
                [0.5, 0.5, 2, 2, 0.333333, 1, 1, 2, 0.333333, 1, 0.5, 3, 2, 0.333333, 0.333333],
                [0.333333, 0.333333, 1, 1, 0.25, 0.5, 0.5, 1, 0.25, 0.5, 0.333333, 2, 1, 0.25, 0.25],
                [2, 2, 4, 4, 1, 3, 3, 4, 1, 3, 2, 5, 4, 1, 1],
                [0.5, 0.5, 2, 2, 0.333333, 1, 1, 2, 0.333333, 1, 0.5, 3, 2, 0.333333, 0.333333],
                [1, 1, 3, 3, 0.5, 2, 2, 3, 0.5, 2, 1, 4, 3, 0.5, 0.5],
                [0.25, 0.25, 0.5, 0.5, 0.2, 0.333333, 0.333333, 0.5, 0.2, 0.333333, 0.25, 1, 0.5, 0.2, 0.2],
                [0.333333, 0.333333, 1, 1, 0.25, 0.5, 0.5, 1, 0.25, 0.5, 0.333333, 2, 1, 0.25, 0.25],
                [2, 2, 4, 4, 1, 3, 3, 4, 1, 3, 2, 5, 4, 1, 1],
                [2, 2, 4, 4, 1, 3, 3, 4, 1, 3, 2, 5, 4, 1, 1]
            ],
            'C12': [
                [1, 1, 0.5, 0.5, 1, 2, 2, 1, 3, 2, 1, 0.5, 1, 1, 3],
                [1, 1, 0.5, 0.5, 1, 2, 2, 1, 3, 2, 1, 0.5, 1, 1, 3],
                [2, 2, 1, 1, 2, 3, 3, 2, 4, 3, 2, 1, 2, 2, 4],
                [2, 2, 1, 1, 2, 3, 3, 2, 4, 3, 2, 1, 2, 2, 4],
                [1, 1, 0.5, 0.5, 1, 2, 2, 1, 3, 2, 1, 0.5, 1, 1, 3],
                [0.5, 0.5, 0.333333, 0.333333, 0.5, 1, 1, 0.5, 2, 1, 0.5, 0.333333, 0.5, 0.5, 2],
                [0.5, 0.5, 0.333333, 0.333333, 0.5, 1, 1, 0.5, 2, 1, 0.5, 0.333333, 0.5, 0.5, 2],
                [1, 1, 0.5, 0.5, 1, 2, 2, 1, 3, 2, 1, 0.5, 1, 1, 3],
                [0.333333, 0.333333, 0.25, 0.25, 0.333333, 0.5, 0.5, 0.333333, 1, 0.5, 0.333333, 0.25, 0.333333, 0.333333, 1],
                [0.5, 0.5, 0.333333, 0.333333, 0.5, 1, 1, 0.5, 2, 1, 0.5, 0.333333, 0.5, 0.5, 2],
                [1, 1, 0.5, 0.5, 1, 2, 2, 1, 3, 2, 1, 0.5, 1, 1, 3],
                [2, 2, 1, 1, 2, 3, 3, 2, 4, 3, 2, 1, 2, 2, 4],
                [1, 1, 0.5, 0.5, 1, 2, 2, 1, 3, 2, 1, 0.5, 1, 1, 3],
                [1, 1, 0.5, 0.5, 1, 2, 2, 1, 3, 2, 1, 0.5, 1, 1, 3],
                [0.333333, 0.333333, 0.25, 0.25, 0.333333, 0.5, 0.5, 0.333333, 1, 0.5, 0.333333, 0.25, 0.333333, 0.333333, 1]
            ],
            'C13': [
                [1, 1, 0.5, 0.5, 1, 2, 2, 0.5, 1, 2, 1, 3, 0.5, 1, 1],
                [1, 1, 0.5, 0.5, 1, 2, 2, 0.5, 1, 2, 1, 3, 0.5, 1, 1],
                [2, 2, 1, 1, 2, 3, 3, 1, 2, 3, 2, 4, 1, 2, 2],
                [2, 2, 1, 1, 2, 3, 3, 1, 2, 3, 2, 4, 1, 2, 2],
                [1, 1, 0.5, 0.5, 1, 2, 2, 0.5, 1, 2, 1, 3, 0.5, 1, 1],
                [0.5, 0.5, 0.333333, 0.333333, 0.5, 1, 1, 0.333333, 0.5, 1, 0.5, 2, 0.333333, 0.5, 0.5],
                [0.5, 0.5, 0.333333, 0.333333, 0.5, 1, 1, 0.333333, 0.5, 1, 0.5, 2, 0.333333, 0.5, 0.5],
                [2, 2, 1, 1, 2, 3, 3, 1, 2, 3, 2, 4, 1, 2, 2],
                [1, 1, 0.5, 0.5, 1, 2, 2, 0.5, 1, 2, 1, 3, 0.5, 1, 1],
                [0.5, 0.5, 0.333333, 0.333333, 0.5, 1, 1, 0.333333, 0.5, 1, 0.5, 2, 0.333333, 0.5, 0.5],
                [1, 1, 0.5, 0.5, 1, 2, 2, 0.5, 1, 2, 1, 3, 0.5, 1, 1],
                [0.333333, 0.333333, 0.25, 0.25, 0.333333, 0.5, 0.5, 0.25, 0.333333, 0.5, 0.333333, 1, 0.25, 0.333333, 0.333333],
                [2, 2, 1, 1, 2, 3, 3, 1, 2, 3, 2, 4, 1, 2, 2],
                [1, 1, 0.5, 0.5, 1, 2, 2, 0.5, 1, 2, 1, 3, 0.5, 1, 1],
                [1, 1, 0.5, 0.5, 1, 2, 2, 0.5, 1, 2, 1, 3, 0.5, 1, 1]
            ],
            'C14': [
                [1, 1, 0.5, 0.5, 0.333333, 1, 1, 2, 3, 1, 1, 4, 2, 1, 3],
                [1, 1, 0.5, 0.5, 0.333333, 1, 1, 2, 3, 1, 1, 4, 2, 1, 3],
                [2, 2, 1, 1, 0.5, 2, 2, 3, 4, 2, 2, 5, 3, 2, 4],
                [2, 2, 1, 1, 0.5, 2, 2, 3, 4, 2, 2, 5, 3, 2, 4],
                [3, 3, 2, 2, 1, 3, 3, 4, 5, 3, 3, 6, 4, 3, 5],
                [1, 1, 0.5, 0.5, 0.333333, 1, 1, 2, 3, 1, 1, 4, 2, 1, 3],
                [1, 1, 0.5, 0.5, 0.333333, 1, 1, 2, 3, 1, 1, 4, 2, 1, 3],
                [0.5, 0.5, 0.333333, 0.333333, 0.25, 0.5, 0.5, 1, 2, 0.5, 0.5, 3, 1, 0.5, 2],
                [0.333333, 0.333333, 0.25, 0.25, 0.2, 0.333333, 0.333333, 0.5, 1, 0.333333, 0.333333, 2, 0.5, 0.333333, 1],
                [1, 1, 0.5, 0.5, 0.333333, 1, 1, 2, 3, 1, 1, 4, 2, 1, 3],
                [1, 1, 0.5, 0.5, 0.333333, 1, 1, 2, 3, 1, 1, 4, 2, 1, 3],
                [0.25, 0.25, 0.2, 0.2, 0.166667, 0.25, 0.25, 0.333333, 0.5, 0.25, 0.25, 1, 0.333333, 0.25, 0.5],
                [0.5, 0.5, 0.333333, 0.333333, 0.25, 0.5, 0.5, 1, 2, 0.5, 0.5, 3, 1, 0.5, 2],
                [1, 1, 0.5, 0.5, 0.333333, 1, 1, 2, 3, 1, 1, 4, 2, 1, 3],
                [0.333333, 0.333333, 0.25, 0.25, 0.2, 0.333333, 0.333333, 0.5, 1, 0.333333, 0.333333, 2, 0.5, 0.333333, 1]
            ],
            'C15': [
                [1, 1, 0.5, 0.5, 1, 2, 2, 1, 3, 2, 1, 0.5, 1, 1, 3],
                [1, 1, 0.5, 0.5, 1, 2, 2, 1, 3, 2, 1, 0.5, 1, 1, 3],
                [2, 2, 1, 1, 2, 3, 3, 2, 4, 3, 2, 1, 2, 2, 4],
                [2, 2, 1, 1, 2, 3, 3, 2, 4, 3, 2, 1, 2, 2, 4],
                [1, 1, 0.5, 0.5, 1, 2, 2, 1, 3, 2, 1, 0.5, 1, 1, 3],
                [0.5, 0.5, 0.333333, 0.333333, 0.5, 1, 1, 0.5, 2, 1, 0.5, 0.333333, 0.5, 0.5, 2],
                [0.5, 0.5, 0.333333, 0.333333, 0.5, 1, 1, 0.5, 2, 1, 0.5, 0.333333, 0.5, 0.5, 2],
                [1, 1, 0.5, 0.5, 1, 2, 2, 1, 3, 2, 1, 0.5, 1, 1, 3],
                [0.333333, 0.333333, 0.25, 0.25, 0.333333, 0.5, 0.5, 0.333333, 1, 0.5, 0.333333, 0.25, 0.333333, 0.333333, 1],
                [0.5, 0.5, 0.333333, 0.333333, 0.5, 1, 1, 0.5, 2, 1, 0.5, 0.333333, 0.5, 0.5, 2],
                [1, 1, 0.5, 0.5, 1, 2, 2, 1, 3, 2, 1, 0.5, 1, 1, 3],
                [2, 2, 1, 1, 2, 3, 3, 2, 4, 3, 2, 1, 2, 2, 4],
                [1, 1, 0.5, 0.5, 1, 2, 2, 1, 3, 2, 1, 0.5, 1, 1, 3],
                [1, 1, 0.5, 0.5, 1, 2, 2, 1, 3, 2, 1, 0.5, 1, 1, 3],
                [0.333333, 0.333333, 0.25, 0.25, 0.333333, 0.5, 0.5, 0.333333, 1, 0.5, 0.333333, 0.25, 0.333333, 0.333333, 1]
            ]
        };

        // --- AHP UTILITY FUNCTIONS ---

        /**
         * Converts the 1-9 scale slider value (1-17) to a numerical importance ratio (1/9 to 9).
         * @param {number} value - Slider value from 1 to 17.
         * @returns {number} The corresponding AHP ratio.
         */
        function scaleToNumber(value) {
            const index = value - 1; // 0 to 16
            const ratios = [
                1 / 9, 1 / 8, 1 / 7, 1 / 6, 1 / 5, 1 / 4, 1 / 3, 1 / 2,
                1,
                2, 3, 4, 5, 6, 7, 8, 9
            ];
            return ratios[index];
        }

        /**
         * Calculates the geometric mean of an array.
         * @param {number[]} arr - Array of numbers.
         * @returns {number} The geometric mean.
         */
        function geometricMean(arr) {
            if (arr.length === 0) return 0;
            let product = arr.reduce((acc, val) => acc * val, 1);
            return Math.pow(product, 1 / arr.length);
        }

        /**
         * Calculates the local weight (eigenvector) of a matrix using the Geometric Mean Method (GMM).
         * @param {number[][]} matrix - The AHP comparison matrix.
         * @returns {{weights: number[], lambdaMax: number}} The calculated weights and lambda max.
         */
        function calculateEigenvector(matrix) {
            const n = matrix.length;
            if (n === 0) return { weights: [], lambdaMax: 0 };

            // 1. Calculate Geometric Mean (Row Mean)
            const geometricMeans = matrix.map(row => geometricMean(row));

            // 2. Normalize Geometric Means to get the Weight Vector (W)
            const sumGM = geometricMeans.reduce((a, b) => a + b, 0);
            const weights = geometricMeans.map(gm => gm / sumGM);

            // 3. Calculate Lambda Max (Î»_max)
            // Simplified formula for GMM lambda_max
            let lambdaMax = 0;
            for (let i = 0; i < n; i++) {
                let sum = 0;
                for (let j = 0; j < n; j++) {
                    sum += matrix[i][j] * weights[j];
                }
                lambdaMax += sum / weights[i];
            }
            lambdaMax /= n;

            return { weights, lambdaMax };
        }

        /**
         * Calculates the Consistency Ratio (CR).
         * @param {number[][]} matrix - The comparison matrix.
         * @param {number} lambdaMax - The calculated Lambda Max.
         * @returns {number} The Consistency Ratio (CR).
         */
        function calculateCR(matrix, lambdaMax) {
            const n = matrix.length;
            if (n <= 2) return 0; // Perfectly consistent

            // Consistency Index (CI)
            const CI = (lambdaMax - n) / (n - 1);

            // Random Index (RI)
            const RI_n = RI[n - 1];

            // Consistency Ratio (CR)
            if (RI_n === 0) return 0;
            return CI / RI_n;
        }

        // --- GLOBAL STATE AND QUESTION DATA ---

        let currentQuestionIndex = 0;
        const matrixData = {}; // Stores user inputs for matrices
        const stepResults = {}; // Stores calculated weights and CRs

        // All 25 questions definitions
        const QUESTIONS = [];
        let questionCounter = 1;

        // --- 1. G -> B Matrix (5x5) Questions ---
        const B_CRITERIA_KEYS = Object.keys(B_CRITERIA_NAMES);
        for (let i = 0; i < B_CRITERIA_KEYS.length; i++) {
            for (let j = i + 1; j < B_CRITERIA_KEYS.length; j++) {
                QUESTIONS.push({
                    id: `G_B_${questionCounter++}`,
                    layer: 'G',
                    row: B_CRITERIA_KEYS[i],
                    col: B_CRITERIA_KEYS[j],
                    name1: B_CRITERIA_NAMES[B_CRITERIA_KEYS[i]],
                    name2: B_CRITERIA_NAMES[B_CRITERIA_KEYS[j]],
                    matrixKey: 'G_B',
                    n: 5,
                });
            }
        }

        // --- 2. B -> C Matrices (5 sets of 3x3) Questions ---
        Object.entries(B_MAPPING).forEach(([B_key, C_keys]) => {
            for (let i = 0; i < C_keys.length; i++) {
                for (let j = i + 1; j < C_keys.length; j++) {
                    QUESTIONS.push({
                        id: `${B_key}_C_${questionCounter++}`,
                        layer: 'B',
                        row: C_keys[i],
                        col: C_keys[j],
                        name1: C_CRITERIA_NAMES[C_keys[i]],
                        name2: C_CRITERIA_NAMES[C_keys[j]],
                        matrixKey: B_key,
                        n: 3,
                    });
                }
            }
        });

        // Initialize matrix data storage
        function initializeMatrixData() {
            Object.keys(B_MAPPING).forEach(bKey => {
                matrixData[bKey] = new Array(3).fill(0).map(() => new Array(3).fill(1));
            });
            matrixData['G_B'] = new Array(5).fill(0).map(() => new Array(5).fill(1));
        }
        initializeMatrixData();


        // --- UI RENDER FUNCTIONS ---

        function updateSliderLabel(value, labelElement, name1, name2) {
            const val = parseInt(value);
            // AHP 1-9 scale terms in Chinese:
            const ahpTerms = [
                `${name2} ç»å¯¹é‡è¦ (9)`, `${name2} å¼ºçƒˆé‡è¦ (8)`, `${name2} éå¸¸é‡è¦ (7)`, `${name2} ç¨å¼ºé‡è¦ (6)`, `${name2} é‡è¦ (5)`, `${name2} ç•¥é‡è¦ (4)`, `${name2} ç¨å¾®é‡è¦ (3)`, `${name2} ç•¥å¾®é‡è¦ (2)`,
                `åŒç­‰é‡è¦ (1)`,
                `${name1} ç•¥å¾®é‡è¦ (2)`, `${name1} ç¨å¾®é‡è¦ (3)`, `${name1} ç•¥é‡è¦ (4)`, `${name1} é‡è¦ (5)`, `${name1} ç¨å¼ºé‡è¦ (6)`, `${name1} éå¸¸é‡è¦ (7)`, `${name1} å¼ºçƒˆé‡è¦ (8)`, `${name1} ç»å¯¹é‡è¦ (9)`
            ];

            labelElement.textContent = ahpTerms[val - 1];
        }

        function renderQuestion(index) {
            const q = QUESTIONS[index];
            if (!q) return;

            const container = document.getElementById('question-container');
            const progressText = document.getElementById('progress-text');
            container.innerHTML = '';

            // Determine criteria names for the row/col (A or C)
            const name1 = q.name1;
            const name2 = q.name2;

            const content = `
                <div class="bg-blue-50 border-l-4 border-blue-600 text-blue-800 p-4 mb-4 rounded-lg shadow-md">
                    <p class="font-bold text-xl">${q.layer === 'G' ? GOAL : B_CRITERIA_NAMES[q.matrixKey]} å±‚æ¬¡</p>
                    ${q.layer !== 'G' ? `<p class="text-base text-blue-700 mt-1">å½“å‰æ¯”è¾ƒ: ${B_CRITERIA_NAMES[q.matrixKey]} ä¸‹çš„å­å‡†åˆ™</p>` : ''}
                </div>

                <div class="p-8 bg-white rounded-xl shadow-lg border border-gray-100">
                    <p class="text-2xl font-bold text-gray-700 mb-8">
                        <span class="text-blue-600">Q${index + 1}/${QUESTIONS.length}:</span>
                        è¯·åˆ¤æ–­ <span class="text-green-600 font-extrabold">${name1}</span> ç›¸å¯¹äº <span class="text-red-600 font-extrabold">${name2}</span> çš„é‡è¦ç¨‹åº¦ã€‚
                    </p>

                    <div class="flex justify-between text-sm font-bold text-gray-500 mb-2">
                        <span class="text-red-600">${name2} ç»å¯¹é‡è¦</span>
                        <span>åŒç­‰é‡è¦</span>
                        <span class="text-green-600">${name1} ç»å¯¹é‡è¦</span>
                    </div>

                    <input type="range" min="1" max="17" value="9" id="ahp-slider" class="ahp-slider" data-q-id="${q.id}">

                    <div class="mt-6 p-4 bg-gray-50 rounded-lg border text-center">
                        <p class="text-xl text-gray-600 font-semibold">æ‚¨çš„é€‰æ‹©ï¼š<br><span id="slider-label" class="font-bold text-gray-800 text-2xl mt-1 block">åŒç­‰é‡è¦ (1)</span></p>
                    </div>
                </div>
            `;
            container.innerHTML = content;

            const slider = document.getElementById('ahp-slider');
            const sliderLabel = document.getElementById('slider-label');

            // Set initial value from saved data
            const savedValue = localStorage.getItem(q.id);
            if (savedValue) {
                slider.value = parseInt(savedValue);
            }

            // Update label on load
            updateSliderLabel(slider.value, sliderLabel, name1, name2);

            // Add event listener
            slider.addEventListener('input', (e) => {
                updateSliderLabel(e.target.value, sliderLabel, name1, name2);
            });

            // Update controls
            document.getElementById('prev-btn').style.display = index > 0 ? 'inline-flex' : 'none';
            document.getElementById('next-btn').style.display = index < QUESTIONS.length - 1 ? 'inline-flex' : 'none';
            document.getElementById('finish-btn').style.display = index === QUESTIONS.length - 1 ? 'inline-flex' : 'none';
            document.getElementById('next-btn').style.display = index === QUESTIONS.length - 1 ? 'none' : 'inline-flex';

            progressText.textContent = `å½“å‰è¿›åº¦ï¼š${index + 1} / ${QUESTIONS.length} é¢˜`;
        }

        function saveAnswer(index) {
            const q = QUESTIONS[index];
            if (!q) return;

            const slider = document.getElementById('ahp-slider');
            const value = slider.value;
            localStorage.setItem(q.id, value); // Save to localStorage for persistence

            const ratio = scaleToNumber(value);

            // Get the indices for the matrix
            const rowKeys = q.layer === 'G' ? B_CRITERIA_KEYS : B_MAPPING[q.matrixKey];
            const rowIndex = rowKeys.indexOf(q.row);
            const colIndex = rowKeys.indexOf(q.col);

            // Update the matrix data
            const matrix = matrixData[q.matrixKey];
            if (rowIndex !== -1 && colIndex !== -1) {
                matrix[rowIndex][colIndex] = ratio;
                matrix[colIndex][rowIndex] = 1 / ratio;
            } else {
                console.error("Matrix index error:", q.row, q.col, rowIndex, colIndex);
            }
        }


        // --- CALCULATION AND RESULTS FUNCTIONS ---

        function runAHPCalculation() {
            // 1. Calculate weights and CR for G -> B matrix (5x5)
            const gMatrix = matrixData['G_B'];
            const { weights: bWeights, lambdaMax: bLambdaMax } = calculateEigenvector(gMatrix);
            stepResults['G_B'] = {
                weights: bWeights,
                cr: calculateCR(gMatrix, bLambdaMax),
                criteria: B_CRITERIA_KEYS,
                names: B_CRITERIA_KEYS.map(k => B_CRITERIA_NAMES[k])
            };

            // 2. Calculate weights and CR for B -> C matrices (5 sets of 3x3)
            const cWeightsLocal = new Array(C_ORDER.length).fill(0);
            const cGlobalWeights = []; // Store C weights for display/interpretation

            Object.entries(B_MAPPING).forEach(([B_key, C_keys], bIndex) => {
                const bMatrix = matrixData[B_key];
                const { weights: cLocalWeights, lambdaMax: cLambdaMax } = calculateEigenvector(bMatrix);

                stepResults[B_key] = {
                    weights: cLocalWeights,
                    cr: calculateCR(bMatrix, cLambdaMax),
                    criteria: C_keys,
                    names: C_keys.map(k => C_CRITERIA_NAMES[k])
                };

                // Store C local weights, mapping back to the C_ORDER index
                C_keys.forEach((cKey, localIndex) => {
                    const globalCIndex = C_ORDER.indexOf(cKey);
                    // Global C weight = Local C weight * Global B weight
                    const globalWeight = cLocalWeights[localIndex] * bWeights[bIndex];
                    cWeightsLocal[globalCIndex] = globalWeight;
                    cGlobalWeights.push({
                        name: C_CRITERIA_NAMES[cKey],
                        score: globalWeight
                    });
                });
            });
            stepResults.cGlobalWeights = cGlobalWeights.sort((a, b) => b.score - a.score);

            // 3. Calculate Global A Weights (Final Scores)
            const aAlternatives = Object.keys(A_ALTERNATIVES_NAMES);
            const finalScores = new Array(aAlternatives.length).fill(0);

            // C -> A matrices are 15x15. Calculate A weights relative to C first.
            const aWeightsRelativeC = {};
            C_ORDER.forEach(cKey => {
                const cMatrix = C_TO_A_MATRICES[cKey];
                const { weights: aWeights, lambdaMax: aLambdaMax } = calculateEigenvector(cMatrix);
                aWeightsRelativeC[cKey] = {
                    weights: aWeights,
                    cr: calculateCR(cMatrix, aLambdaMax),
                };
            });

            // Final Global Score Calculation: Î£ (A_weight_relative_Ci * Global_C_weight)
            for (let aIndex = 0; aAlternatives.length > aIndex; aIndex++) {
                let totalScore = 0;
                for (let cIndex = 0; C_ORDER.length > cIndex; cIndex++) {
                    const cKey = C_ORDER[cIndex];
                    const globalCWeight = cWeightsLocal[cIndex];
                    const aWeightRelativeC = aWeightsRelativeC[cKey].weights[aIndex];
                    totalScore += aWeightRelativeC * globalCWeight;
                }
                finalScores[aIndex] = totalScore;
            }

            // 4. Rank Results
            const rankedResults = aAlternatives.map((key, index) => ({
                name: A_ALTERNATIVES_NAMES[key],
                key: key,
                score: finalScores[index]
            })).sort((a, b) => b.score - a.score);

            stepResults.finalRanking = rankedResults;
            stepResults.aWeightsRelativeC = aWeightsRelativeC;
            stepResults.cWeightsLocal = cWeightsLocal; // Store for interpretation

            renderResults();
        }

        function getAlternativeWeights(alternativeKey) {
            const alternativeIndex = Object.keys(A_ALTERNATIVES_NAMES).indexOf(alternativeKey);
            const weights = [];
            C_ORDER.forEach((cKey, cIndex) => {
                const globalCWeight = stepResults.cWeightsLocal[cIndex];
                const aWeightRelativeC = stepResults.aWeightsRelativeC[cKey].weights[alternativeIndex];
                weights.push({
                    cName: C_CRITERIA_NAMES[cKey],
                    totalContribution: aWeightRelativeC * globalCWeight
                });
            });
            return weights.sort((a, b) => b.totalContribution - a.totalContribution);
        }

        function createInterpretationText(rankedResults) {
            if (!rankedResults || rankedResults.length === 0) return "<p>æ— æ³•ç”Ÿæˆè§£è¯»ï¼šè®¡ç®—ç»“æœç¼ºå¤±ã€‚</p>";

            const top1 = rankedResults[0];
            const top2 = rankedResults[1];

            // æ‰¾å‡ºæœ€é‡è¦çš„å‡ ä¸ªCå‡†åˆ™
            const topC = stepResults.cGlobalWeights.slice(0, 3);
            const topCNames = topC.map(c => c.name).join('ã€');

            // æ‰¾å‡ºç¬¬ä¸€åæ–¹æ¡ˆçš„ä¸»è¦è´¡çŒ®å‡†åˆ™
            const top1Weights = getAlternativeWeights(top1.key);
            const top1KeyC = top1Weights.slice(0, 2).map(w => w.cName).join('å’Œ');

            let text = `
                <p><strong>æ€»ä½“åå¥½åˆ†æï¼š</strong>æ ¹æ®æ‚¨åœ¨ç¬¬ä¸€ã€äºŒçº§å‡†åˆ™é—´çš„åˆ¤æ–­ï¼Œæ‚¨è®¤ä¸ºæœ€é‡è¦çš„å†³ç­–å‡†åˆ™åŒ…æ‹¬ï¼š
                <span class="font-bold text-blue-600">${topCNames}</span> (æƒé‡åˆ†åˆ«ä¸º ${topC.map(c => c.score.toFixed(4)).join('/')})ã€‚
                æ‚¨çš„æœ€ç»ˆæ¨èç»“æœæ˜¯åŸºäºè¿™äº›åå¥½ï¼Œå¯¹æ‰€æœ‰æ–¹æ¡ˆåœ¨ 15 ä¸ªäºŒçº§å‡†åˆ™ä¸‹çš„å¾—åˆ†è¿›è¡ŒåŠ æƒæ±‡æ€»å¾—å‡ºçš„ã€‚</p>
                <p><strong>ğŸ¥‡ æœ€ä½³æ¨è (${top1.name})ï¼š</strong>è¯¥æ–¹æ¡ˆä»¥ <span class="text-green-600 font-bold">${(top1.score * 100).toFixed(2)}%</span> çš„æ€»æƒé‡æ’åç¬¬ä¸€ã€‚
                è¿™ä¸»è¦å¾—ç›Šäºå…¶åœ¨ <span class="font-bold text-green-600">${top1KeyC}</span> ç­‰å‡†åˆ™ä¸Šçš„ä¼˜å¼‚è¡¨ç°ï¼Œè¿™äº›å› ç´ ä¸æ‚¨çœ‹é‡çš„å†³ç­–æ–¹å‘é«˜åº¦å»åˆã€‚</p>
            `;

            if (top2) {
                 // æ‰¾å‡ºç¬¬äºŒåæ–¹æ¡ˆçš„ä¸»è¦è´¡çŒ®å‡†åˆ™
                const top2Weights = getAlternativeWeights(top2.key);
                const top2KeyC = top2Weights.slice(0, 2).map(w => w.cName).join('å’Œ');

                text += `
                    <p><strong>ğŸ¥ˆ ç¬¬äºŒåæ¨è (${top2.name})ï¼š</strong>è¯¥æ–¹æ¡ˆæ€»æƒé‡ä¸º ${(top2.score * 100).toFixed(2)}%ï¼Œç´§éšå…¶åã€‚
                    å®ƒåœ¨ <span class="font-bold">${top2KeyC}</span> ç­‰æ–¹é¢è¡¨ç°çªå‡ºï¼Œæ˜¯ä»…æ¬¡äºé¦–é€‰çš„æœ‰åŠ›å¤‡é€‰é¡¹ã€‚</p>
                `;
            }

            text += `<p>ğŸ’¡ å»ºè®®æ‚¨æ·±å…¥åˆ†ææ€»æƒé‡æ’åå‰ä¸‰çš„æ–¹æ¡ˆï¼Œç»“åˆæ‚¨å¯¹è‡ªèº«èµ„æºå’Œå¤–éƒ¨ç¯å¢ƒçš„ç†è§£ï¼Œåšå‡ºæœ€ç»ˆå†³ç­–ã€‚</p>`;

            return text;
        }


        function renderResults() {
            document.getElementById('question-container').style.display = 'none';
            document.getElementById('controls').style.display = 'none';
            document.getElementById('home-screen').style.display = 'none';
            const resultsContainer = document.getElementById('results-container');
            resultsContainer.style.display = 'block';

            // --- 1. Top 3 Ranking ---
            const rankingDiv = document.getElementById('ranking');
            rankingDiv.innerHTML = '';
            const top3 = stepResults.finalRanking.slice(0, 3);
            const colors = ['gradient-bg', 'bg-gray-400', 'bg-amber-600'];
            const titles = ['ğŸ¥‡ æœ€ä½³æ¨è', 'ğŸ¥ˆ ç¬¬äºŒå', 'ğŸ¥‰ ç¬¬ä¸‰å'];

            top3.forEach((item, index) => {
                const html = `
                    <div class="${colors[index]} p-6 rounded-xl shadow-2xl text-white transform hover:scale-105 transition duration-300">
                        <h4 class="text-white text-2xl font-extrabold mb-1">${titles[index]}</h4>
                        <p class="text-4xl font-black">${item.name}</p>
                        <p class="text-sm opacity-90 mt-2">æ€»è¯„åˆ†: ${(item.score * 100).toFixed(4)}%</p>
                    </div>
                `;
                rankingDiv.innerHTML += html;
            });

            // --- 2. Result Interpretation ---
            document.getElementById('interpretation-content').innerHTML = createInterpretationText(stepResults.finalRanking);

            // --- 3. C-Layer Global Weights Table ---
            const cGlobalWeightsBody = document.getElementById('c-global-weights-body');
            cGlobalWeightsBody.innerHTML = '';
            stepResults.cGlobalWeights.forEach(item => {
                cGlobalWeightsBody.innerHTML += `
                    <tr class="hover:bg-gray-50">
                        <td class="py-3 px-4 border-b font-medium">${item.name}</td>
                        <td class="py-3 px-4 border-b font-mono">${(item.score).toFixed(6)}</td>
                    </tr>
                `;
            });


            // --- 4. Global Alternatives Weights Table ---
            const globalWeightsBody = document.getElementById('global-weights-body');
            globalWeightsBody.innerHTML = '';
            stepResults.finalRanking.forEach(item => {
                globalWeightsBody.innerHTML += `
                    <tr class="hover:bg-gray-50">
                        <td class="py-3 px-4 border-b">${item.name} (${item.key})</td>
                        <td class="py-3 px-4 border-b font-mono">${(item.score).toFixed(6)}</td>
                    </tr>
                `;
            });

            // --- 5. Consistency Checks and Local Weights Table ---
            const consistencyBody = document.getElementById('consistency-body');
            consistencyBody.innerHTML = '';

            // G -> B Matrix CR
            const gResult = stepResults['G_B'];
            consistencyBody.innerHTML += createCRRow(
                'G â†’ B (ç›®æ ‡å±‚)',
                gResult.cr,
                gResult.weights,
                gResult.names,
                true // Is B-Layer
            );

            // B -> C Matrices CRs
            Object.entries(B_MAPPING).forEach(([B_key, C_keys]) => {
                const bResult = stepResults[B_key];
                consistencyBody.innerHTML += createCRRow(
                    `${B_CRITERIA_NAMES[B_key]} â†’ C (äºŒçº§å‡†åˆ™)`,
                    bResult.cr,
                    bResult.weights,
                    bResult.names
                );
            });

            // C -> A Matrices CRs
            C_ORDER.forEach(cKey => {
                const cr = stepResults.aWeightsRelativeC[cKey].cr;
                consistencyBody.innerHTML += createCRRow(
                    `${C_CRITERIA_NAMES[cKey]} â†’ A (æ–¹æ¡ˆ)`,
                    cr,
                    null,
                    null,
                    false,
                    true // Is C->A
                );
            });
        }

        function createCRRow(matrixName, crValue, weights, names, isBLayer = false, isCALayer = false) {
            // C->A matrices generated from scores will have CR of 0, check for very small number
            const isPass = isCALayer ? (crValue < 0.0001) : (crValue <= 0.1);
            const statusClass = isPass ? 'cr-pass' : 'cr-fail';
            const statusText = isPass ? 'é€šè¿‡ (CR â‰¤ 0.1)' : 'å¤±è´¥ (CR > 0.1)';

            let weightDetails = 'N/A';
            if (weights && names) {
                weightDetails = weights.map((w, i) => `${names[i]}: ${(w).toFixed(4)}`).join(' | ');
            }
            if (isCALayer) {
                // For C->A, explicitly state it uses pre-set data
                weightDetails = `<span class="text-sm text-gray-500">åŸºäºé¢„è®¾ä¸“å®¶æ‰“åˆ†ç”Ÿæˆï¼Œæƒé‡å·²ç»¼åˆè®¡ç®—ã€‚</span>`;
                // If C->A, enforce "é€šè¿‡" status since the score method matrix is perfectly consistent (CR=0)
                const perfectStatusClass = 'cr-pass';
                const perfectStatusText = 'é€šè¿‡ (CR â‰ˆ 0)';
                return `
                    <tr class="hover:bg-gray-50">
                        <td class="py-3 px-4 border-b font-medium">${matrixName}</td>
                        <td class="py-3 px-4 border-b font-mono text-sm">${(crValue).toFixed(4)}</td>
                        <td class="py-3 px-4 border-b">
                            <span class="inline-block px-3 py-1 text-xs font-semibold rounded-full ${perfectStatusClass}">
                                ${perfectStatusText}
                            </span>
                        </td>
                        <td class="py-3 px-4 border-b text-xs text-gray-600">${weightDetails}</td>
                    </tr>
                `;
            } else if (isBLayer) {
                // For G->B or B->C matrices, show user-input consistency check result
                weightDetails = weights.map((w, i) => `${names[i]}: ${(w).toFixed(4)}`).join(' | ');
            }

            return `
                <tr class="hover:bg-gray-50">
                    <td class="py-3 px-4 border-b font-medium">${matrixName}</td>
                    <td class="py-3 px-4 border-b font-mono text-sm">${(crValue).toFixed(4)}</td>
                    <td class="py-3 px-4 border-b">
                        <span class="inline-block px-3 py-1 text-xs font-semibold rounded-full ${statusClass}">
                            ${statusText}
                        </span>
                    </td>
                    <td class="py-3 px-4 border-b text-xs text-gray-600">${weightDetails}</td>
                </tr>
            `;
        }

        // --- PRESET LOAD FUNCTION ---

        function loadPresetAnswers(presetKey) {
            // 1. Clear current session data
            localStorage.clear();
            initializeMatrixData();

            const presetData = PRESET_ANSWERS[presetKey];

            // Map G_B answers
            presetData.G_B.forEach((sliderValue, index) => {
                const q = QUESTIONS.find(q => q.layer === 'G' && q.id === `G_B_${index + 1}`);
                if (q) {
                    localStorage.setItem(q.id, sliderValue);
                    const ratio = scaleToNumber(sliderValue);
                    const rowKeys = B_CRITERIA_KEYS;
                    const rowIndex = rowKeys.indexOf(q.row);
                    const colIndex = rowKeys.indexOf(q.col);
                    matrixData['G_B'][rowIndex][colIndex] = ratio;
                    matrixData['G_B'][colIndex][rowIndex] = 1 / ratio;
                }
            });

            // Map B_C answers
            Object.entries(B_MAPPING).forEach(([B_key, C_keys]) => {
                const bq = QUESTIONS.filter(q => q.layer === 'B' && q.matrixKey === B_key);
                presetData[B_key].forEach((sliderValue, index) => {
                    const q = bq[index];
                    if (q) {
                        localStorage.setItem(q.id, sliderValue);
                        const ratio = scaleToNumber(sliderValue);
                        const rowKeys = C_keys;
                        const rowIndex = rowKeys.indexOf(q.row);
                        const colIndex = rowKeys.indexOf(q.col);
                        matrixData[B_key][rowIndex][colIndex] = ratio;
                        matrixData[B_key][colIndex][rowIndex] = 1 / ratio;
                    }
                });
            });

            // 2. Run calculation and render results
            runAHPCalculation();
        }

        function startTest() {
            // Re-initialize state when starting a new test
            localStorage.clear();
            initializeMatrixData();

            document.getElementById('home-screen').style.display = 'none';
            document.getElementById('question-container').style.display = 'block';
            document.getElementById('controls').style.display = 'flex';
            document.getElementById('results-container').style.display = 'none';

            renderQuestion(currentQuestionIndex);
        }

        // --- EVENT LISTENERS AND INITIALIZATION ---
        document.addEventListener('DOMContentLoaded', () => {

            // Start Test Button
            document.getElementById('start-test-btn').addEventListener('click', startTest);

            // Preset Buttons Listener (New Feature)
            document.querySelectorAll('.preset-btn').forEach(button => {
                button.addEventListener('click', (e) => {
                    const presetKey = e.target.getAttribute('data-preset');
                    loadPresetAnswers(presetKey);
                });
            });

            // Go to previous question
            document.getElementById('prev-btn').addEventListener('click', () => {
                if (currentQuestionIndex > 0) {
                    saveAnswer(currentQuestionIndex);
                    currentQuestionIndex--;
                    renderQuestion(currentQuestionIndex);
                }
            });

            // Go to next question
            document.getElementById('next-btn').addEventListener('click', () => {
                if (currentQuestionIndex < QUESTIONS.length - 1) {
                    saveAnswer(currentQuestionIndex);
                    currentQuestionIndex++;
                    renderQuestion(currentQuestionIndex);
                }
            });

            // Finish button
            document.getElementById('finish-btn').addEventListener('click', () => {
                saveAnswer(currentQuestionIndex);

                // Final validation (check if all questions answered)
                const allAnswered = QUESTIONS.every(q => localStorage.getItem(q.id) !== null);
                if (allAnswered) {
                    runAHPCalculation();
                } else {
                    // Alert uses custom function to avoid native alert()
                    const alertBox = document.createElement('div');
                    alertBox.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
                    alertBox.innerHTML = `
                        <div class="bg-white p-6 rounded-lg shadow-xl max-w-sm">
                            <h5 class="text-xl font-bold mb-3 text-red-600">æç¤º</h5>
                            <p>è¯·å®Œæˆæ‰€æœ‰ ${QUESTIONS.length} ä¸ªé‡è¦æ€§åˆ¤æ–­åå†è®¡ç®—ç»“æœï¼</p>
                            <button onclick="this.parentNode.parentNode.remove()" class="mt-4 px-4 py-2 bg-red-600 text-white rounded-lg">ç¡®å®š</button>
                        </div>
                    `;
                    document.body.appendChild(alertBox);
                }
            });

            // Initially show the home screen
            document.getElementById('question-container').style.display = 'none';
            document.getElementById('controls').style.display = 'none';
            document.getElementById('home-screen').style.display = 'block';
            document.getElementById('results-container').style.display = 'none';

            // Hide the next button if there's only one question left (should show finish)
            if (QUESTIONS.length === 1) {
                document.getElementById('finish-btn').style.display = 'inline-flex';
                document.getElementById('next-btn').style.display = 'none';
            }
        });
    </script>
</body>
</html>
